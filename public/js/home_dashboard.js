$(function () {
    $('#datetimepicker-progress-pekerjaan').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-form-mr-start, #datetimepicker-form-mr-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-form-mr1-start, #datetimepicker-form-mr1-end').datetimepicker({
        format: 'YYYY-MM',
    });
    $('#datetimepicker-status-paket-belum-lelang-start, #datetimepicker-status-paket-belum-lelang-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-form-mr2-start, #datetimepicker-form-mr2-end').datetimepicker({
        format: 'YYYY-MM',
    });
    $('#datetimepicker-form-mr3-start, #datetimepicker-form-mr1-end').datetimepicker({
        format: 'YYYY-MM',
    });
    $('#datetimepicker-form-mr4-start, #datetimepicker-form-mr1-end').datetimepicker({
        format: 'YYYY-MM',
    });
    $('#datetimepicker-status-penanganan-start,#datetimepicker-status-penanganan-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-pengaduan-upt-start,#datetimepicker-pengaduan-upt-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-balai-pengaduan-terbanyak-start,#datetimepicker-balai-pengaduan-terbanyak-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-pengaduan-kategori-start,#datetimepicker-pengaduan-kategori-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-spengaduan-start,#datetimepicker-spengaduan-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-integritas-start,#datetimepicker-integritas-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-perencanaan-start,#datetimepicker-perencanaan-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-pembebasan-start,#datetimepicker-pembebasan-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-tender-start,#datetimepicker-tender-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-pelaksanaan-start,#datetimepicker-pelaksanaan-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-pemanfaatan-start,#datetimepicker-pemanfaatan-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    // $('#datetimepicker-balai-pengaduan-terbanyak-start,#datetimepicker-balai-pengaduan-terbanyak-end').datetimepicker({
    //     format: 'YYYY-MM-DD',
    // });
    $('#datetimepicker-status-siptl-start,#datetimepicker-status-siptl-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-status-verifikasi-start,#datetimepicker-status-verifikasi-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-persentase-itjen-start,#datetimepicker-persentase-itjen-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-perizinan-monev-start,#datetimepicker-perizinan-monev-end').datetimepicker({
        format: 'YYYY-MM-DD',
        // minDate: '2021-11-01'
    });
    $('#datetimepicker-perijinan-start,#datetimepicker-perijinan-end').datetimepicker({
        format: 'YYYY-MM-DD',
        // minDate: '2021-11-01'
    });
    $('#datetimepicker-pengaduan-start,#datetimepicker-pengaduan-end').datetimepicker({
        format: 'YYYY-MM-DD',
        // minDate: '2021-11-01'
    });
    $('#datetimepicker-perijinan-tujuan-start, #datetimepicker-perijinan-tujuan-end').datetimepicker({
        format: 'YYYY-MM-DD',
        // minDate: '2021-11-01'
    });
    $('#datetimepicker-perijinan-batas-waktu-start,#datetimepicker-perijinan-batas-waktu-end').datetimepicker({
        format: 'YYYY-MM-DD',
        // minDate: '2021-11-01'
    });
    $('#datetimepicker-perijinan-table-start,#datetimepicker-perijinan-table-end').datetimepicker({
        format: 'YYYY-MM-DD',
        // minDate: '2021-11-01'
    });
    $('#datetimepicker-pengadaan').datetimepicker({
        format: 'YYYY',
    });
    $('#datetimepicker-year-mr').datetimepicker({
        format: 'YYYY',
    });
    $('#datetimepicker-year-keldok').datetimepicker({
        format: 'YYYY',
    });

    // Kemajuan Pelaksanaan Lelang Date Picker
    $('#datetimepicker-kemajuan').datetimepicker({
        format: 'YYYY',
    });

    // Pemantauan Proses Lelang Date Picker
    $('#datetimepicker-proses-lelang').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-tahun-proses-lelang').datetimepicker({
        format: 'YYYY',
    });

    // Status Paket yang belum lelang date picker
    $('#datetimepicker-tahun-status-paket-belum-lelang').datetimepicker({
        format: 'YYYY',
    });

    // Nilai Kontrak HPS date picker
    $('#datetimepicker-tahun-kontrak-hps').datetimepicker({
        format: 'YYYY',
    });

    // Progres Keuangan date picker
    $('#datetimepicker-tahun-status_progress_pekerjaan').datetimepicker({
        format: 'YYYY',
    });

    // Progres Fisik date picker
    $('#datetimepicker-tahun-status_progress_fisik').datetimepicker({
        format: 'YYYY',
    });

    $('#datetimepicker-kontrak-hps').datetimepicker({
        format: 'YYYY-MM-DD',
    });

    // Pemantauan Durasi Terkontrak Date Picker
    $('#datetimepicker-terkontrak').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-tahun-terkontrak').datetimepicker({
        format: 'YYYY',
    });

    // Pengadaan Banding Date Picker
    $('#datetimepicker-tahun-pengadaan-banding').datetimepicker({
        format: 'YYYY',
    });

    $('#datetimepicker-rekap-table-start,#datetimepicker-rekap-table-end').datetimepicker({
        format: 'YYYY-MM-DD',
        // minDate: '2021-11-01'
    });

    // $('#datetimepicker-balai-pengaduan-terbanyak-table-start,#datetimepicker-balai-pengaduan-terbanyak-table-end').datetimepicker({
    //     format: 'YYYY-MM-DD',
    //     // minDate: '2021-11-01'
    // });


    $('#datetimepicker-pengadaan').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-kemajuan').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-proses-lelang').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-kontrak-hps').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-terkontrak').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-pengadaan-banding1,#datetimepicker-pengadaan-banding2').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-perizinan-terlambat-start,#datetimepicker-perizinan-terlambat-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });
    $('#datetimepicker-perizinan-terlambat-full-start,#datetimepicker-perizinan-terlambat-full-end').datetimepicker({
        format: 'YYYY-MM-DD',
    });

    setChartBPL();
    setChartKKN();
})

// MR Table
$('#datetimepicker-year-mr').on('dp.change', function () {
    setMRTable();
})

// Kelengkapan dokumen
$('#datetimepicker-year-keldok').on('dp.change', function () {
    setKelengkapanDokumenChart();
})

// Pengadaan Banding On Change
$('#datetimepicker-tahun-pengadaan-banding').on('dp.change', function () {
    changeViewDate("kontrak", $("#tahun-pengadaan-banding").val(), '#tgl-pengadaan-banding1')
    changeViewDate("kontrak", $("#tahun-pengadaan-banding").val(), '#tgl-pengadaan-banding2')
})

// Pemantauan Durasi Terkontrak Tahun On Change
$('#datetimepicker-tahun-terkontrak').on('dp.change', function () {
    changeViewDate("kontrak", $("#tahun-terkontrak").val(), '#tgl-terkontrak')
})

// Pemantauan Durasi Proses Lelang Tahun On Change
$('#datetimepicker-tahun-proses-lelang').on('dp.change', function () {
    changeViewDate("kontrak", $("#tahun-proses-lelang").val(), '#proses-lelang')
})

// Status Paket Belum Lelang Tahun On Change
$('#datetimepicker-tahun-status-paket-belum-lelang').on('dp.change', function () {
    changeViewDate("kontrak", $("#tahun-status-paket-belum-lelang").val(), '#status-paket-belum-lelang-tgl')
})

// Status Kontrak HPS
$('#datetimepicker-tahun-kontrak-hps').on('dp.change', function () {
    changeViewDate("kontrak", $("#tahun-kontrak-hps").val(), '#tgl-kontrak-hps')
})

// Progres Keuangan Tahun On Change
$('#datetimepicker-tahun-status_progress_pekerjaan').on('dp.change', function () {
    changeViewDate("profiles", $("#tahun-status_progress_pekerjaan").val(), '#status_progress_pekerjaan')
})

// Progres Fisik Tahun On Change
$('#datetimepicker-tahun-status_progress_fisik').on('dp.change', function () {
    changeViewDate("profiles", $("#tahun-status_progress_fisik").val(), '#status_progress_fisik')
})

$('#datetimepicker-progress-pekerjaan').on('dp.change', function () {
    setProgressPekerjaanChart();
})

setProgressPekerjaanChart();
$('#status_progress_pekerjaan').on('change', function () {
    setProgressPekerjaanChart();
})

setProgressFisikChart();
$('#status_progress_fisik').on('change', function () {
    setProgressFisikChart();
})

$('#datetimepicker-form-mr-start,#datetimepicker-form-mr-end').on('dp.change', function () {
    setFormMrChart();
})
$('#datetimepicker-form-mr1-start,#datetimepicker-form-mr1-end').on('dp.change', function () {
    setFormMr1Chart();
})
$('#datetimepicker-form-mr2-start,#datetimepicker-form-mr2-end').on('dp.change', function () {
    setFormMr2Chart();
})
$('#datetimepicker-form-mr3-start,#datetimepicker-form-mr3-end').on('dp.change', function () {
    setFormMr3Chart();
})
$('#datetimepicker-form-mr4-start,#datetimepicker-form-mr4-end').on('dp.change', function () {
    setFormMr4Chart();
})
$('#datetimepicker-perizinan-monev-start,#datetimepicker-perizinan-monev-end').on('dp.change', function () {
    setPerizinanMonevChart();
})

$('#perizinan-monev-upt').on('change', function () {
    setPerizinanMonevChart();
})

// Pengaduan UPT
$('#datetimepicker-pengaduan-upt-start,#datetimepicker-pengaduan-upt-end').on('dp.change', function () {
    setPengaduanUPTChart();
})
// Pengaduan UPT
$('#datetimepicker-balai-pengaduan-terbanyak-start,#datetimepicker-balai-pengaduan-terbanyak-end').on('dp.change', function () {
    setBalaiPengaduanTerbanyakChart();
})

// Pengaduan Kategori
$('#datetimepicker-pengaduan-kategori-start,#datetimepicker-pengaduan-kategori-end').on('dp.change', function () {
    setPengaduanKategoriChart();
})

$('#datetimepicker-integritas-start,#datetimepicker-integritas-end').on('dp.change', function () {
    setIntegritasChart();
})

$('#integritas-batas-waktu-upt').on('change', function () {
    setIntegritasChart();
    console.log("clicked");
})
$('#perencanaan-batas-waktu-upt').on('change', function () {
    setPerencanaanChart();
    console.log("clicked");
})
$('#pembebasan-batas-waktu-upt').on('change', function () {
    setPembebasanChart();
    console.log("clicked");
})
$('#tender-batas-waktu-upt').on('change', function () {
    setTenderChart();
    console.log("clicked");
})
$('#pelaksanaan-batas-waktu-upt').on('change', function () {
    setPelaksanaanChart();
    console.log("clicked");
})
$('#pemanfaatan-batas-waktu-upt').on('change', function () {
    setPemanfaatanChart();
    console.log("clicked");
})

$('#datetimepicker-perencanaan-start,#datetimepicker-perencanaan-end').on('dp.change', function () {
    setPerencanaanChart();
})

$('#datetimepicker-pembebasan-start,#datetimepicker-pembebasan-end').on('dp.change', function () {
    setPembebasanChart();
})

$('#datetimepicker-tender-start,#datetimepicker-tender-end').on('dp.change', function () {
    setTenderChart();
})

$('#datetimepicker-pelaksanaan-start,#datetimepicker-pelaksanaan-end').on('dp.change', function () {
    setPelaksanaanChart();
})

$('#datetimepicker-pemanfaatan-start,#datetimepicker-pemanfaatan-end').on('dp.change', function () {
    setPemanfaatanChart();
})


$('#datetimepicker-status-siptl-start,#datetimepicker-status-siptl-end').on('dp.change', function () {
    setStatusSiptlChart();
})
$('#datetimepicker-status-verifikasi-start,#datetimepicker-status-verifikasi-end').on('dp.change', function () {
    setStatusVerifikasiChart();
})
$('#datetimepicker-persentase-itjen-start,#datetimepicker-persentase-itjen-end').on('dp.change', function () {
    setPersentaseItjenChart();
})

// Chart Top 10 Balai terlambat terbanyak
$('#datetimepicker-perizinan-terlambat-start,#datetimepicker-perizinan-terlambat-end').on('dp.change', function () {
    setPerizinanTerlambatChart();
})

// Chart Full Balai terlambat terbanyak
$('#datetimepicker-perizinan-terlambat-full-start,#datetimepicker-perizinan-terlambat-full-end').on('dp.change', function () {
    setPerizinanTerlambatFullChart();
})

// Chart Status Pemberian Izin
$('#datetimepicker-perijinan-batas-waktu-start,#datetimepicker-perijinan-batas-waktu-end').on('dp.change', function () {
    setPerijinanBatasWaktuChart();
})

$('#perijinan-batas-waktu-upt').on('change', function () {
    setPerijinanBatasWaktuChart();
})
$('#datetimepicker-status-penanganan-start,#datetimepicker-status-penanganan-end').on('dp.change', function () {
    setStatusChart();
})
$('#datetimepicker-perijinan-start,#datetimepicker-perijinan-end').on('dp.change', function () {
    setPerijinanChart();
})

// Chart Perizinan
$('#perijinan-upt').on('change', function () {
    setPerijinanChart();
})

$('#datetimepicker-pengaduan-start,#datetimepicker-pengaduan-end').on('dp.change', function () {
    setPengaduanChart();
})

$('#pengaduan-upt').on('change', function () {
    setPengaduanChart();
})
$('#datetimepicker-spengaduan-start,#datetimepicker-spengaduan-end').on('dp.change', function () {
    ssetPengaduanChart();
})
$('#datetimepicker-perijinan-tujuan-start, #datetimepicker-perijinan-tujuan-end').on('dp.change', function () {
    setPerijinanTujuanChart();
})
$('#datetimepicker-status-paket-belum-lelang-start, #datetimepicker-status-paket-belum-lelang-end').on('dp.change', function () {
    setStatusPaketBelumLelang();
})

// Progres Perizinan
$('#datetimepicker-perijinan-table-start,#datetimepicker-perijinan-table-end').on('dp.change', function () {
    setTablePerijinan();
})
$('#perijinan-table-upt').on('change', function () {
    setTablePerijinan();
})

$('#datetimepicker-rekap-table-start,#datetimepicker-rekap-table-end').on('dp.change', function () {
    setTableRekapPengaduan();
})

$('#rekap-table-upt').on('change', function () {
    setTableRekapPengaduan();
})

$('#datetimepicker-pengadaan').on('dp.change', function () {
    setChartPengadaan();
})
$('#datetimepicker-proses-lelang').on('dp.change', function () {
    setChartProsesLelang();
})
// $('#datetimepicker-terkontrak').on('dp.change', function () {
//     setChartTerkontrak();
// })
$('#tgl-terkontrak').on('change', function () {
    setChartTerkontrak();
})
setChartTerkontrak();

$('#datetimepicker-kemajuan').on('dp.change', function () {
    setChartKemajuan();
})

setChartKontrakHPS();
$('#tgl-kontrak-hps').on('change', function () {
    setChartKontrakHPS();
})
// $('#datetimepicker-pengadaan-banding1,#datetimepicker-pengadaan-banding2').on('dp.change', function () {
//     setTablePengadaanBanding();
// })

$("#status-paket-belum-lelang-tgl").on('change', function () {
    setStatusPaketBelumLelang();
});
setStatusPaketBelumLelang();

$('#tgl-pengadaan-banding1,#tgl-pengadaan-banding2').on('change', function () {
    setTablePengadaanBanding();
})
setTablePengadaanBanding();

$('#proses-lelang').on('change', function () {
    setChartProsesLelang();
})
setChartProsesLelang();

function setMRTable() {
    var year = $('#year-mr').val();
    $.get(CURRENT_URL, {
        year,
        'function': 'tableMR'
    }, function (res) {
        console.log(res);
        changeViewMRTable(res);
    })
}

function changeViewMRTable(data) {
    var tbody = "";
    $('.table-mr-body').html(tbody)

    var unit = [
        {
            'upr': "UPR-T1",
            'upt': "UNOR",
            'param' : 'T1_UNOR',
            "jumlah": 1,
        },
        {
            'upr': "UPR-T2",
            'upt': "UKER",
            'param' : 'T2_UKER',
            "jumlah": 11,
        },
        {
            'upr': "UPR-T2",
            'upt': "BALAI (BBWS/BWS)",
            'param' : 'T2_BALAI',
            "jumlah": 37,
        },
        {
            'upr': "UPR-T2",
            'upt': "BALTEK",
            'param' : 'T2_BALTEK',
            "jumlah": 9,
        },
        {
            'upr': "UPR-T3",
            'upt': "UKER",
            'param' : 'T3_UKER',
            "jumlah": 14,
        },
        {
            'upr': "UPR-T3",
            'upt': "BALAI (BBWS/BWS)",
            'param' : 'T3_BALAI',
            "jumlah": 184,
        },
        {
            'upr': "UPR-T3",
            'upt': "BALTEK",
            'param' : 'T3_BALTEK',
            "jumlah": 9,
        },
        {
            'upr': "UPR-T3",
            'upt': "SKPD TP-OP",
            'param' : 'T3_SKPD',
            "jumlah": 28,
        },
    ];

    var match = false;
    var no = 0;
    $.each(unit, function (i, v) {
        console.log(i, ' - ', v);
        no = no + 1;
        $.each(data.data.data, function (it, vt) {
            if (v.upr == vt.upr && v.upt == vt.level_user) {
                console.log("sini");
                match = true;
                tbody += "<tr><td>"+no+"</td><td>"+vt.upr+"</td><td><a href='"+mainServerUrl+"/detail?unit="+v.param+"'>"+vt.level_user+"</a></td><td class='text-right'>"+v.jumlah+"</td><td class='text-right'>"+vt.komitmen_v+"</td><td class='text-right'>"+vt.komitmen_d+"</td><td class='text-right'>"+(v.jumlah-(parseInt(vt.komitmen_d)+parseInt(vt.komitmen_v)))+"</td><td class='text-right'>"+vt.komitmen_t1_v+"</td><td class='text-right'>"+vt.komitmen_t1_d+"</td><td class='text-right'>"+(v.jumlah-(parseInt(vt.komitmen_t1_d)+parseInt(vt.komitmen_t1_v)))+"</td><td class='text-right'>"+vt.komitmen_t2_v+"</td><td class='text-right'>"+vt.komitmen_t2_d+"</td><td class='text-right'>"+(v.jumlah-(parseInt(vt.komitmen_t2_d)+parseInt(vt.komitmen_t2_v)))+"</td><td class='text-right'>"+vt.komitmen_t3_v+"</td><td class='text-right'>"+vt.komitmen_t3_d+"</td><td class='text-right'>"+(v.jumlah-(parseInt(vt.komitmen_t3_d)+parseInt(vt.komitmen_t3_v)))+"</td><td class='text-right'>"+vt.komitmen_t4_v+"</td><td class='text-right'>"+vt.komitmen_t4_d+"</td><td class='text-right'>"+(v.jumlah-(parseInt(vt.komitmen_t4_d)+parseInt(vt.komitmen_t4_v)))+"</td>"
            }
        })

        if(match == false) {
            tbody += "<tr><td>"+no+"</td><td>"+v.upr+"</td><td><a href='"+mainServerUrl+"/detail?unit="+v.param+"'>"+v.upt+"</a></td><td class='text-right'>"+v.jumlah+"</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>"+v.jumlah+"</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>"+v.jumlah+"</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>"+v.jumlah+"</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>"+v.jumlah+"</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>"+v.jumlah+"</td> "
        }
        match = false;
    })

    $('.table-mr-body').html(tbody)

    var tfoot = "";
    total = data.data.total
        tfoot = "<tr class='label-success'><th colspan='3'>Total Jumlah</th><th class='text-right'>293</th><th class='text-right'>"+total.total_komitmen_v+"</th><th class='text-right'>"+total.total_komitmen_d+"</th><th class='text-right'>"+(293-(parseInt(total.total_komitmen_d)+parseInt(total.total_komitmen_v)))+"</th><th class='text-right'>"+total.total_komitmen_t1_v+"</th><th class='text-right'>"+total.total_komitmen_t1_d+"</th><th class='text-right'>"+(293-(parseInt(total.total_komitmen_t1_d)+parseInt(total.total_komitmen_t1_v)))+"</th><th class='text-right'>"+total.total_komitmen_t2_v+"</th><th class='text-right'>"+total.total_komitmen_t2_d+"</th><th class='text-right'>"+(293-(parseInt(total.total_komitmen_t2_d)+parseInt(total.total_komitmen_t2_v)))+"</th><th class='text-right'>"+total.total_komitmen_t3_v+"</th><th class='text-right'>"+total.total_komitmen_t3_d+"</th><th class='text-right'>"+(293-(parseInt(total.total_komitmen_t3_d)+parseInt(total.total_komitmen_t3_v)))+"</th><th class='text-right'>"+total.total_komitmen_t4_v+"</th><th class='text-right'>"+total.total_komitmen_t4_d+"</th><th class='text-right'>"+(293-(parseInt(total.total_komitmen_t3_d)+parseInt(total.total_komitmen_t3_v)))+"</th><tr>";
    $('.table-mr-foot').html(tfoot)

    var persentase = data.data.persentase;
    var terverifikasi = "<tr><td class='text-center h2'>" + persentase.komitmen_v + "%</td><td class='text-center h2'>" + persentase.komitmen_t1_v + "%</td><td class='text-center h2'>" + persentase.komitmen_t2_v + "%</td><td class='text-center h2'>" + persentase.komitmen_t3_v + "%</td><td class='text-center h2'>" + persentase.komitmen_t4_v + "%</td></tr>";
    $('.table-mr-terverifikasi-body').html(terverifikasi)

    var draft = "<tr><td class='text-center h2'>" + persentase.komitmen_d + "%</td><td class='text-center h2'>" + persentase.komitmen_t1_d + "%</td><td class='text-center h2'>" + persentase.komitmen_t2_d + "%</td><td class='text-center h2'>" + persentase.komitmen_t3_d + "%</td><td class='text-center h2'>" + persentase.komitmen_t4_d + "%</td></tr>";
    $('.table-mr-draft-body').html(draft)

    var belum = "<tr><td class='text-center h2'>" + persentase.komitmen_b + "%</td><td class='text-center h2'>" + persentase.komitmen_t1_b + "%</td><td class='text-center h2'>" + persentase.komitmen_t2_b + "%</td><td class='text-center h2'>" + persentase.komitmen_t3_b + "%</td><td class='text-center h2'>" + persentase.komitmen_t4_b + "%</td></tr>";
    $('.table-mr-belum-body').html(belum)
}


// function changeViewMRTable(data) {
//     var tbody = "";
//     $('.table-mr-body').html(tbody)

//     var unit = [
//         {
//             'upr': "UPR-T1",
//             'upt': "UNOR",
//             'param': 'T1_UNOR',
//             "jumlah": 1,
//         },
//         {
//             'upr': "UPR-T2",
//             'upt': "UKER",
//             'param': 'T2_UKER',
//             "jumlah": 11,
//         },
//         {
//             'upr': "UPR-T2",
//             'upt': "BALAI (BBWS/BWS)",
//             'param': 'T2_BALAI',
//             "jumlah": 37,
//         },
//         {
//             'upr': "UPR-T2",
//             'upt': "BALTEK",
//             'param': 'T2_BALTEK',
//             "jumlah": 9,
//         },
//         {
//             'upr': "UPR-T3",
//             'upt': "UKER",
//             'param': 'T3_UKER',
//             "jumlah": 14,
//         },
//         {
//             'upr': "UPR-T3",
//             'upt': "BALAI (BBWS/BWS)",
//             'param': 'T3_BALAI',
//             "jumlah": 184,
//         },
//         {
//             'upr': "UPR-T3",
//             'upt': "BALTEK",
//             'param': 'T3_BALTEK',
//             "jumlah": 9,
//         },
//         {
//             'upr': "UPR-T3",
//             'upt': "SKPD TP-OP",
//             'param': 'T3_SKPD',
//             "jumlah": 28,
//         },
//     ];

//     var match = false;
//     var no = 0;
//     $.each(unit, function (i, v) {
//         console.log(i, ' - ', v);
//         no = no + 1;
//         $.each(data.data.data, function (it, vt) {
//             if (v.upr == vt.upr && v.upt == vt.level_user) {
//                 console.log("sini");
//                 match = true;
//                 tbody += "<tr><td>" + no + "</td><td>" + vt.upr + "</td><td><a href='" + mainServerUrl + "/detail?unit=" + v.param + "'>" + vt.level_user + "</a></td><td class='text-right'>" + v.jumlah + "</td><td class='text-right'>" + vt.komitmen_v + "</td><td class='text-right'>" + vt.komitmen_d + "</td><td class='text-right'>" + (v.jumlah - (parseInt(vt.komitmen_d) + parseInt(vt.komitmen_v))) + "</td><td class='text-right'>" + vt.komitmen_t1_v + "</td><td class='text-right'>" + vt.komitmen_t1_d + "</td><td class='text-right'>" + (v.jumlah - (parseInt(vt.komitmen_t1_d) + parseInt(vt.komitmen_t1_v))) + "</td><td class='text-right'>" + vt.komitmen_t2_v + "</td><td class='text-right'>" + vt.komitmen_t2_d + "</td><td class='text-right'>" + (v.jumlah - (parseInt(vt.komitmen_t2_d) + parseInt(vt.komitmen_t2_v))) + "</td><td class='text-right'>" + vt.komitmen_t3_v + "</td><td class='text-right'>" + vt.komitmen_t3_d + "</td><td class='text-right'>" + (v.jumlah - (parseInt(vt.komitmen_t3_d) + parseInt(vt.komitmen_t3_v))) + "</td><td class='text-right'>" + vt.komitmen_t4_v + "</td><td class='text-right'>" + vt.komitmen_t4_d + "</td><td class='text-right'>" + (v.jumlah - (parseInt(vt.komitmen_t4_d) + parseInt(vt.komitmen_t4_v))) + "</td>"
//             }
//         })

//         if (match == false) {
//             tbody += "<tr><td>" + no + "</td><td>" + v.upr + "</td><td><a href='" + mainServerUrl + "/detail?unit=" + v.param + "'>" + v.upt + "</a></td><td class='text-right'>" + v.jumlah + "</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>" + v.jumlah + "</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>" + v.jumlah + "</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>" + v.jumlah + "</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>" + v.jumlah + "</td><td class='text-right'>0</td><td class='text-right'>0</td><td class='text-right'>" + v.jumlah + "</td> "
//         }
//         match = false;
//     })

//     $('.table-mr-body').html(tbody)

//     var tfoot = "";
//     total = data.data.total
//     tfoot = "<tr class='label-success'><th colspan='3'>Total Jumlah</th><th class='text-right'>293</th><th class='text-right'>" + total.total_komitmen_v + "</th><th class='text-right'>" + total.total_komitmen_d + "</th><th class='text-right'>" + (293 - (parseInt(total.total_komitmen_d) + parseInt(total.total_komitmen_v))) + "</th><th class='text-right'>" + total.total_komitmen_t1_v + "</th><th class='text-right'>" + total.total_komitmen_t1_d + "</th><th class='text-right'>" + (293 - (parseInt(total.total_komitmen_t1_d) + parseInt(total.total_komitmen_t1_v))) + "</th><th class='text-right'>" + total.total_komitmen_t2_v + "</th><th class='text-right'>" + total.total_komitmen_t2_d + "</th><th class='text-right'>" + (293 - (parseInt(total.total_komitmen_t2_d) + parseInt(total.total_komitmen_t2_v))) + "</th><th class='text-right'>" + total.total_komitmen_t3_v + "</th><th class='text-right'>" + total.total_komitmen_t3_d + "</th><th class='text-right'>" + (293 - (parseInt(total.total_komitmen_t3_d) + parseInt(total.total_komitmen_t3_v))) + "</th><th class='text-right'>" + total.total_komitmen_t4_v + "</th><th class='text-right'>" + total.total_komitmen_t4_d + "</th><th class='text-right'>" + (293 - (parseInt(total.total_komitmen_t3_d) + parseInt(total.total_komitmen_t3_v))) + "</th><tr>";
//     $('.table-mr-foot').html(tfoot)

//     console.log(total)

//     var persentase = data.data.persentase;
//     var terverifikasi = "<tr><td class='text-center h2'>" + persentase.komitmen_v + "%</td><td class='text-center h2'>" + persentase.komitmen_t1_v + "%</td><td class='text-center h2'>" + persentase.komitmen_t2_v + "%</td><td class='text-center h2'>" + persentase.komitmen_t3_v + "%</td><td class='text-center h2'>" + persentase.komitmen_t4_v + "%</td></tr>";
//     $('#chartVerif').html(chartVerifikasi(persentase))

//     var draft = "<tr><td class='text-center h2'>" + persentase.komitmen_d + "%</td><td class='text-center h2'>" + persentase.komitmen_t1_d + "%</td><td class='text-center h2'>" + persentase.komitmen_t2_d + "%</td><td class='text-center h2'>" + persentase.komitmen_t3_d + "%</td><td class='text-center h2'>" + persentase.komitmen_t4_d + "%</td></tr>";
//     $('.table-mr-draft-body').html(draft)

//     var belum = "<tr><td class='text-center h2'>" + persentase.komitmen_b + "%</td><td class='text-center h2'>" + persentase.komitmen_t1_b + "%</td><td class='text-center h2'>" + persentase.komitmen_t2_b + "%</td><td class='text-center h2'>" + persentase.komitmen_t3_b + "%</td><td class='text-center h2'>" + persentase.komitmen_t4_b + "%</td></tr>";
//     $('.table-mr-belum-body').html(belum)
// }

function chartVerifikasi(persentase) {
    let myChart = document.getElementById('chartVerif').getContext('2d');

    let massPopChart = new Chart(myChart, {
        type: 'bar',
        data: {
            labels: ['Total', 'Triwulan I', 'Triwulan II', 'Triwulan III', 'Triwulan IV'],
            datasets: [{
                label: 'Terverifikasi',
                backgroundColor: 'rgba(12, 44, 247, 0.5)',
                data: [
                    persentase.komitmen_v, persentase.komitmen_t1_v, persentase.komitmen_t2_v, persentase.komitmen_t3_v, persentase.komitmen_t4_v
                ]
            },
            {
                label: 'Draft',
                backgroundColor: 'rgba(247, 161, 12, 0.5)',
                data: [
                    persentase.komitmen_d, persentase.komitmen_t1_d, persentase.komitmen_t2_d, persentase.komitmen_t3_d, persentase.komitmen_t4_d
                ]
            },
            {
                label: 'Belum',
                backgroundColor: 'rgba(255, 0, 0, 0.5)',
                data: [
                    persentase.komitmen_b, persentase.komitmen_t1_b, persentase.komitmen_t2_b, persentase.komitmen_t3_b, persentase.komitmen_t4_b
                ]
            },
            ]
        },

        options: {
            scales: {
                y: {
                    beginAtZero: true,
                },
                yAxes: [{
                    ticks: {
                        callback: function (value, index, values) {
                            return value + " %";
                        }
                    }
                }]
            }
        }
    });

    return massPopChart;
}


function setProgressPekerjaanChart() {
    var date = $('#status_progress_pekerjaan').val();
    var thang = $("#tahun-status_progress_pekerjaan").val();
    $.get(CURRENT_URL, {
        date,
        thang,
        'function': 'chartProgressPekerjaan'
    }, function (res) {
        console.log(res);
        changeViewProgressPekerjaanChart(res);
        changeViewProgressPekerjaanTable(res);
    })
}

// Start Progress Keuangan
const progressPekerjaanChartCtx = document.getElementById('progress-pekerjaan-chart');
var progressPekerjaanChartCurrent;
function changeViewProgressPekerjaanChart(data) {
    if (progressPekerjaanChartCurrent) {
        progressPekerjaanChartCurrent.destroy();
    }
    progressPekerjaanChartCurrent = new Chart(progressPekerjaanChartCtx, {
        type: 'pie',
        data: {
            labels: ['DEV > 10%', '0% < Dev <= 10%', '-10% < Dev <= 0', '-30 < Dev <= -10%', 'Dev <= -30%'],
            datasets: [
                {
                    label: 'Progress Pekerjaan',
                    data: [
                        data.dev1.persentase,
                        data.dev2.persentase,
                        data.dev3.persentase,
                        data.dev4.persentase,
                        data.dev5.persentase
                    ],
                    backgroundColor: [
                        'rgba(0, 204, 0, 1)', //green #00cc00
                        'rgba(102, 102, 255, 1)', //blue #6666ff
                        'rgba(128, 128, 128, 1)', //grey #808080
                        'rgba(204,204,0, 1)', // yellow #cccc00
                        'rgba(255, 102, 102, 1)', //red #ff6666
                    ],
                },
            ]
        },
        plugins: [ChartDataLabels],
        options: {
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),

                }
            },
        },
    });
}

function changeViewProgressPekerjaanTable(data) {
    $($('.data-deviasi-persentase')[0]).text(data.dev1.persentase + '%');
    $($('.data-deviasi-jumlah_satker')[0]).text(data.dev1.jumlah_satker);
    $($('.data-deviasi-persentase')[1]).text(data.dev2.persentase + '%');
    $($('.data-deviasi-jumlah_satker')[1]).text(data.dev2.jumlah_satker);
    $($('.data-deviasi-persentase')[2]).text(data.dev3.persentase + '%');
    $($('.data-deviasi-jumlah_satker')[2]).text(data.dev3.jumlah_satker);
    $($('.data-deviasi-persentase')[3]).text(data.dev4.persentase + '%');
    $($('.data-deviasi-jumlah_satker')[3]).text(data.dev4.jumlah_satker);
    $($('.data-deviasi-persentase')[4]).text(data.dev5.persentase + '%');
    $($('.data-deviasi-jumlah_satker')[4]).text(data.dev5.jumlah_satker);

    $('.data-deviasi-persentase-total').text(data.persentase_total + '%');
    $('.data-deviasi-satker-total').text(data.satker_total);
}

// End Progress Keuangan

// Start Chart Fisik
function setProgressFisikChart() {
    var date = $('#status_progress_fisik').val();
    var thang = $("#tahun-status_progress_fisik").val();
    $.get(CURRENT_URL, {
        date,
        thang,
        'function': 'chartProgressFisik'
    }, function (res) {
        console.log(res);
        changeViewProgressFisikChart(res);
        changeViewProgressFisikTable(res);
    })
}

const progressFisikChartCtx = document.getElementById('progress-fisik-chart');
var progressFisikChartCurrent;
function changeViewProgressFisikChart(data) {
    if (progressFisikChartCurrent) {
        progressFisikChartCurrent.destroy();
    }
    progressFisikChartCurrent = new Chart(progressFisikChartCtx, {
        type: 'pie',
        data: {
            labels: ['DEV > 10%', '0% < Dev <= 10%', '-10% < Dev <= 0', '-30 < Dev <= -10%', 'Dev <= -30%'],
            datasets: [
                {
                    label: 'Progress Pekerjaan',
                    data: [
                        data.dev1.persentase,
                        data.dev2.persentase,
                        data.dev3.persentase,
                        data.dev4.persentase,
                        data.dev5.persentase
                    ],
                    backgroundColor: [

                        'rgba(0, 204, 0, 1)', //green #00cc00
                        'rgba(102, 102, 255, 1)', //blue #6666ff
                        'rgba(128, 128, 128, 1)', //grey #808080
                        'rgba(204,204,0, 1)', // yellow #cccc00
                        'rgba(255, 102, 102, 1)', //red #ff6666
                    ],
                },
            ]
        },
        plugins: [ChartDataLabels],
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),

                }
            },
        },
    });
}

function changeViewProgressFisikTable(data) {
    $($('.data-deviasi-fisik-persentase')[0]).text(data.dev1.persentase + '%');
    $($('.data-deviasi-fisik-jumlah_satker')[0]).text(data.dev1.jumlah_satker);
    $($('.data-deviasi-fisik-persentase')[1]).text(data.dev2.persentase + '%');
    $($('.data-deviasi-fisik-jumlah_satker')[1]).text(data.dev2.jumlah_satker);
    $($('.data-deviasi-fisik-persentase')[2]).text(data.dev3.persentase + '%');
    $($('.data-deviasi-fisik-jumlah_satker')[2]).text(data.dev3.jumlah_satker);
    $($('.data-deviasi-fisik-persentase')[3]).text(data.dev4.persentase + '%');
    $($('.data-deviasi-fisik-jumlah_satker')[3]).text(data.dev4.jumlah_satker);
    $($('.data-deviasi-fisik-persentase')[4]).text(data.dev5.persentase + '%');
    $($('.data-deviasi-fisik-jumlah_satker')[4]).text(data.dev5.jumlah_satker);

    $('.data-deviasi-fisik-persentase-total').text(data.persentase_total + '%');
    $('.data-deviasi-fisik-satker-total').text(data.satker_total);
}
// End Chart Fisik


function setFormMrChart() {
    var date_start = $('#form-mr-start').val();
    var date_end = $('#form-mr-end').val();
    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartFormMr'
    }, function (res) {
        console.log(res);
        changeViewMrChart(res);
    })
}

const mrChartCtx = document.getElementById('mr-chart');
var mrChart;
function changeViewMrChart(data) {
    if (mrChart) {
        mrChart.destroy();
    }

    var levels = []
    var data_dikirim = [];
    var data_terverifikasi = [];
    var data_tidak_terverifikasi = [];

    $.each(data, function (i, v) {
        levels.push(i);
    });

    $.each(data, function (i, v) {
        data_dikirim.push(v.status_0);
    });

    $.each(data, function (i, v) {
        data_terverifikasi.push(v.status_1);
    });
    $.each(data, function (i, v) {
        data_tidak_terverifikasi.push(v.status_2);
    });

    mrChart = new Chart(mrChartCtx, {
        type: 'bar',
        data: {
            labels: levels,
            datasets: [{
                label: 'Dikirim',
                data: data_dikirim,
                backgroundColor: [
                    'rgba(102, 102, 255, 1)',
                ],
                borderWidth: 1
            },
            {
                label: 'Terverifikasi',
                data: data_terverifikasi,
                backgroundColor: [
                    'rgba(0, 204, 0, 1)',
                ],
                borderWidth: 1
            },
            {
                label: 'Tidak Terverifikasi',
                data: data_tidak_terverifikasi,
                backgroundColor: [
                    'rgba(255, 102, 102, 1)',
                ],
                borderWidth: 1
            }]
        },
        plugins: [ChartDataLabels],
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                },
            },
            responsive: true,
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),

                }
            },
        },
    });
}

function setFormMr1Chart() {
    var date_start = $('#form-mr1-start').val();
    var date_end = $('#form-mr1-end').val();
    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartFormMr1'
    }, function (res) {
        console.log(res);
        changeViewMr1Chart(res);
    })
}

const mr1ChartCtx = document.getElementById('mr1-chart');
var mr1Chart;
function changeViewMr1Chart(data) {
    if (mr1Chart) {
        mr1Chart.destroy();
    }

    var datasets = [];
    var c = 0
    $.each(data.datasets, function (i, v) {
        datasets.push({
            label: i,
            data: v,
            backgroundColor: colours[c++]
        });
    })

    mr1Chart = new Chart(mr1ChartCtx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: datasets
        },
        plugins: [ChartDataLabels],
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                },
            },
            responsive: true,
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),

                }
            },
        },
    });
}

function setFormMr2Chart() {
    var date_start = $('#form-mr2-start').val();
    var date_end = $('#form-mr2-end').val();
    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartFormMr2'
    }, function (res) {
        console.log(res);
        changeViewMr2Chart(res);
    })
}

const mr2ChartCtx = document.getElementById('mr2-chart');
var mr2Chart;
function changeViewMr2Chart(data) {
    if (mr2Chart) {
        mr2Chart.destroy();
    }

    var datasets = [];
    var c = 0;
    $.each(data.datasets, function (i, v) {
        datasets.push({
            label: i,
            data: v,
            backgroundColor: colours[c++]
        });
    })

    mr2Chart = new Chart(mr2ChartCtx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: datasets
        },
        plugins: [ChartDataLabels],
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                },
            },
            responsive: true,
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}

function setFormMr3Chart() {
    var date_start = $('#form-mr3-start').val();
    var date_end = $('#form-mr3-end').val();
    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartFormMr3'
    }, function (res) {
        console.log(res);
        changeViewMr3Chart(res);
    })
}

const mr3ChartCtx = document.getElementById('mr3-chart');
var mr3Chart;
function changeViewMr3Chart(data) {
    if (mr3Chart) {
        mr3Chart.destroy();
    }

    var datasets = [];
    var c = 0
    $.each(data.datasets, function (i, v) {
        datasets.push({
            label: i,
            data: v,
            backgroundColor: colours[c++]
        });
    })

    mr3Chart = new Chart(mr3ChartCtx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: datasets
        },
        plugins: [ChartDataLabels],
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                },
            },
            responsive: true,
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}

function setFormMr4Chart() {
    var date_start = $('#form-mr4-start').val();
    var date_end = $('#form-mr4-end').val();
    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartFormMr4'
    }, function (res) {
        console.log(res);
        changeViewMr4Chart(res);
    })
}

const mr4ChartCtx = document.getElementById('mr4-chart');
var mr4Chart;
function changeViewMr4Chart(data) {
    if (mr4Chart) {
        mr4Chart.destroy();
    }

    var datasets = [];
    var c = 0
    $.each(data.datasets, function (i, v) {
        datasets.push({
            label: i,
            data: v,
            backgroundColor: colours[c++]
        });
    })

    mr4Chart = new Chart(mr4ChartCtx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: datasets
        },
        plugins: [ChartDataLabels],
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                },
            },
            responsive: true,
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}

function setStatusChart() {
    var date_start = $('#status-status-penanganan-start').val();
    var date_end = $('#status-status-penanganan-end').val();
    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartStatus'
    }, function (res) {
        console.log(res);
        changeViewStatusChart(res);
    })
}

var statusChart;
function changeViewStatusChart(data) {
    if (statusChart) {
        statusChart.destroy();
    }

    const statusChartCtx = document.getElementById('status-chart');
    statusChart = new Chart(statusChartCtx, {
        type: 'doughnut',
        data: {
            labels: ['Selesai', 'Proses', 'Belum TL'],
            datasets: [
                {
                    data: [data.selesai, data.proses, data.belum_tl],
                    backgroundColor: [

                        'rgba(0, 222, 128, 1)',
                        'rgba(240, 240, 51, 1)',
                        'rgba(255, 102, 102, 1)',
                    ],
                },
            ]
        },
        plugins: [ChartDataLabels],
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}

function setKelengkapanDokumenChart() {
    var year = $('#year-keldok').val();
    $.get(CURRENT_URL, {
        year,
        'function': 'chartKelengkapanDokumen'
    }, function (res) {
        console.log(res);
        changeViewKelengkapanDokumenChart(res);
    })
}

var kelengkapanDokumenChart;
function changeViewKelengkapanDokumenChart(data) {
    if (kelengkapanDokumenChart) {
        kelengkapanDokumenChart.destroy();
    }

    var datasets = [];
    $.each(data.datasets, function (i, v) {
        var dt = [];
        $.each(v.data, function (x, y) {
            dt.push(y);
        });
        datasets.push({
            label: v.label,
            data: dt,
            backgroundColor: colours[i],
            borderWidth: 1
        })
    })
    console.log(data.labels, datasets)

    const kelengkapanDokumenChartCtx = document.getElementById('kelengkapan-dokumen');
    kelengkapanDokumenChart = new Chart(kelengkapanDokumenChartCtx, {
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: [
                {
                    label: 'Jumlah Data',
                    data: data.data,
                    backgroundColor: [colours[2]],
                    borderWidth: 1
                },
            ],
        },
        plugins: [ChartDataLabels],
        options: {
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),

                }
            },
        },
    });
}

function setPerizinanMonevChart() {
    var date_start = $('#perizinan-monev-start').val();
    var date_end = $('#perizinan-monev-end').val();
    var upt = $("#perizinan-monev-upt").val();
    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartPerizinanMonev'
    }, function (res) {
        console.log(res);
        changeViewPerizinanMonevChart(res);
    })
}

var perizinanMonevChart;
function changeViewPerizinanMonevChart(data) {
    if (perizinanMonevChart) {
        perizinanMonevChart.destroy();
    }

    var datasets = [];
    $.each(data.datasets, function (i, v) {
        var dt = [];
        $.each(v.data, function (x, y) {
            dt.push(y);
        });
        datasets.push({
            label: v.label,
            data: dt,
            backgroundColor: colours[i],
            borderWidth: 1
        })
    })
    console.log(data.labels, datasets)

    const perizinanMonevChartCtx = document.getElementById('perizinan-monev-chart');
    perizinanMonevChart = new Chart(perizinanMonevChartCtx, {
        type: 'pie',
        data: {
            labels: data.labels,
            datasets: [
                {
                    label: 'Jumlah Data',
                    data: data.data,
                    backgroundColor: [colours[0], colours[1]],
                    borderWidth: 1
                },
            ],
        },
        plugins: [ChartDataLabels],
        options: {
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),

                }
            },
        },
    });
}

function setPerijinanChart() {
    var date_start = $('#perijinan-start').val();
    var date_end = $('#perijinan-end').val();
    var upt = $('#perijinan-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartPerijinan'
    }, function (res) {
        console.log(res);
        changeViewPerijinanChart(res);
    })
}

var perijinanChart;
function changeViewPerijinanChart(data) {
    if (perijinanChart) {
        perijinanChart.destroy();
    }

    var datasets = [];
    $.each(data.datasets, function (i, v) {
        var dt = [];
        $.each(v.data, function (x, y) {
            dt.push(y);
        });
        datasets.push({
            label: v.label,
            data: dt,
            backgroundColor: colours[i],
            borderWidth: 1
        })
    })

    var labels = [];
    $.each(data.labels, function (i, v) {
        labels.push(v);
    })
    console.log(data.labels, datasets)

    const perijinanChartCtx = document.getElementById('perijinan-chart');
    perijinanChart = new Chart(perijinanChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels,
            datasets: datasets,
        },
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: true,
                        text: 'Pemohon'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'UPT'
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),

                }
            },
        }
    });
}

// chart pengaduan

function setPengaduanChart() {
    var date_start = $('#pengaduan-start').val();
    var date_end = $('#ppengaduan-end').val();
    var upt = $('#pengaduan-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartPengaduan'
    }, function (res) {
        console.log(res);
        changeViewPengaduanChart(res);
    })
}

var pengaduanChart;
function changeViewPengaduanChart(data) {
    if (pengaduanChart) {
        pengaduanChart.destroy();
    }

    var datasets = [];
    $.each(data.datasets, function (i, v) {
        var dt = [];
        $.each(v.data, function (x, y) {
            dt.push(y);
        });
        datasets.push({
            label: v.label,
            data: dt,
            backgroundColor: colours[i],
            borderWidth: 1
        })
    })

    var labels = [];
    $.each(data.labels, function (i, v) {
        labels.push(v);
    })
    console.log(data.labels, datasets)

    const pengaduanChartCtx = document.getElementById('pengaduan-chart');
    pengaduanChart = new Chart(pengaduanChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels,
            datasets: datasets,
        },
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: true,
                        text: 'Pemohon'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'UPT'
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),

                }
            },
        }
    });
}

// end chart pengaduan ----------------------------------------------------------------//



// end chart pengaduan ----------------------------------------------------------------//


function setPerijinanTujuanChart() {
    var date_start = $('#perijinan-tujuan-start').val();
    var date_end = $('#perijinan-tujuan-end').val();
    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartPerijinanTujuan'
    }, function (res) {
        console.log(res);
        changeViewPerijinanTujuanChart(res);
    })
}

var perijinanChartTujuan;
function changeViewPerijinanTujuanChart(data) {
    if (perijinanChartTujuan) {
        perijinanChartTujuan.destroy();
    }
    perijinanChartTujuanColour = [];
    $.each(data.labels, function (i, v) {
        perijinanChartTujuanColour.push(colours[i]);
    })

    const perijinanChartTujuanCtx = document.getElementById('perijinan-tujuan-chart');
    var myColors = [];
    $.each(data.labels, function (i, v) {
        myColors.push("rgba(" + Math.floor(Math.random() * 255) + ", " + Math.floor(Math.random() * 255) + ", " + Math.floor(Math.random() * 255) + ")");
    })
    perijinanChartTujuan = new Chart(perijinanChartTujuanCtx, {
        type: 'doughnut',
        data: {
            labels: data.labels,
            datasets: [
                {
                    label: 'Jumlah Data',
                    data: data.data,
                    backgroundColor: myColors,
                    borderWidth: 1
                },
            ]
        },
        plugins: [ChartDataLabels],
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}


// Pengaduan Kategori
function setPengaduanKategoriChart() {
    var date_start = $('#pengaduan-kategori-start').val();
    var date_end = $('#pengaduan-kategori-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartPengaduanKategori'
    }, function (res) {
        console.log(res);
        changeViewPengaduanKategoriChart(res);
    })
}



var pengaduanKategoriChart;
function changeViewPengaduanKategoriChart(data) {
    if (pengaduanKategoriChart) {
        console.log("kategori destroy");
        pengaduanKategoriChart.destroy();
    }

    console.log(data.data.selesai);
    data_selesai = [];
    $.each(data.data.selesai, function (i, v) {
        console.log(v);
        data_selesai.push(v);
    })
    data_proses = [];
    $.each(data.data.proses, function (i, v) {
        data_proses.push(v);
    })
    data_btl = [];
    $.each(data.data.btl, function (i, v) {
        data_btl.push(v);
    })
    data_labels = [];
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
    })

    const pengaduanKategoriChartCtx = document.getElementById('pengaduan-kategori-chart');
    pengaduanKategoriChart = new Chart(pengaduanKategoriChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data_labels,
            datasets: [
                {
                    label: 'Selesai',
                    data: data_selesai,
                    backgroundColor: colours[0],
                    borderWidth: 1
                },
                {
                    label: 'Proses',
                    data: data_proses,
                    backgroundColor: colours[1],
                    borderWidth: 1
                },
                {
                    label: 'BTL',
                    data: data_btl,
                    backgroundColor: colours[2],
                    borderWidth: 1
                },
            ]
        },
        options: {
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    stacked: true,
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

//balai pengaduan terbanyak chart


// 2nd kategori
// Seccond chart pengaduan

function ssetPengaduanChart() {
    var date_start = $('#spengaduan-start').val();
    var date_end = $('#spengaduan-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'schartPengaduan'
    }, function (res) {
        console.log(res);
        schangeViewPengaduanChart(res);
    })
}

var spengaduanChart;
function schangeViewPengaduanChart(data) {
    if (spengaduanChart) {
        console.log("kategori destroy");
        spengaduanChart.destroy();
    }

    console.log(data.data.selesai);
    data_selesai = [];
    $.each(data.data.selesai, function (i, v) {
        console.log(v);
        data_selesai.push(v);
    })
    data_proses = [];
    $.each(data.data.proses, function (i, v) {
        data_proses.push(v);
    })
    data_btl = [];
    $.each(data.data.btl, function (i, v) {
        data_btl.push(v);
    })
    data_labels = [];
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
    })

    const spengaduanChartCtx = document.getElementById('spengaduan-chart');
    spengaduanChart = new Chart(spengaduanChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data_labels,
            axis: 'y',
            datasets: [
                {
                    label: 'Selesai',
                    data: data_selesai,
                    backgroundColor: colours[4],
                    borderWidth: 1
                },
                {
                    label: 'Proses',
                    data: data_proses,
                    backgroundColor: colours[3],
                    borderWidth: 1
                },
                {
                    label: 'BTL',
                    data: data_btl,
                    backgroundColor: colours[5],
                    borderWidth: 1
                },
            ]
        },
        options: {

            indexAxis: 'y',
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    stacked: true,
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// Pengaduan Kategori
function setIntegritasChart() {
    var date_start = $('#integritas-start').val();
    var date_end = $('#integritas-end').val();
    var upt = $('#integritas-batas-waktu-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartIntegritas'
    }, function (res) {
        console.log(res);
        changeViewIntegritasChart(res);
    })
}

var IntegritasChart;
function changeViewIntegritasChart(data) {
    if (IntegritasChart) {
        console.log("kategori destroy");
        IntegritasChart.destroy();
    }

    console.log(data.data.selesai);
    data_selesai = [];
    $.each(data.data.selesai, function (i, v) {
        console.log(v);
        data_selesai.push(v);
    })
    data_proses = [];
    $.each(data.data.proses, function (i, v) {
        data_proses.push(v);
    })
    data_btl = [];
    $.each(data.data.btl, function (i, v) {
        data_btl.push(v);
    })
    data_labels = [];
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
    })

    const integritasChartCtx = document.getElementById('integritas-chart');
    IntegritasChart = new Chart(integritasChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data_labels,
            axis: 'y',
            datasets: [
                {

                    label: 'Selesai',
                    data: data_selesai,
                    backgroundColor: colours[4],
                    borderWidth: 1
                },
                {

                    label: 'Proses',
                    data: data_proses,
                    backgroundColor: colours[3],
                    borderWidth: 1
                },
                {

                    label: 'BTL',
                    data: data_btl,
                    backgroundColor: colours[5],
                    borderWidth: 1
                },
            ]
        },
        options: {
            indexAxis: 'y',
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    stacked: true,
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}


function setPerencanaanChart() {
    var date_start = $('#perencanaan-start').val();
    var date_end = $('#perencanaan-end').val();
    var upt = $('#perencanaan-batas-waktu-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartPerencanaan'
    }, function (res) {
        console.log(res);
        changeViewPerencanaanChart(res);
    })
}

var PerencanaanChart;
function changeViewPerencanaanChart(data) {
    if (PerencanaanChart) {
        console.log("kategori destroy");
        PerencanaanChart.destroy();
    }

    console.log(data.data.selesai);
    data_selesai = [];
    $.each(data.data.selesai, function (i, v) {
        console.log(v);
        data_selesai.push(v);
    })
    data_proses = [];
    $.each(data.data.proses, function (i, v) {
        data_proses.push(v);
    })
    data_btl = [];
    $.each(data.data.btl, function (i, v) {
        data_btl.push(v);
    })
    data_labels = [];
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
    })

    const perencanaanChartCtx = document.getElementById('perencanaan-chart');
    PerencanaanChart = new Chart(perencanaanChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data_labels,
            axis: 'y',
            datasets: [
                {

                    label: 'Selesai',
                    data: data_selesai,
                    backgroundColor: colours[4],
                    borderWidth: 1
                },
                {

                    label: 'Proses',
                    data: data_proses,
                    backgroundColor: colours[3],
                    borderWidth: 1
                },
                {

                    label: 'BTL',
                    data: data_btl,
                    backgroundColor: colours[5],
                    borderWidth: 1
                },
            ]
        },
        options: {
            indexAxis: 'y',
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    stacked: true,
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// perencanaan
function setPembebasanChart() {
    var date_start = $('#pembebasan-start').val();
    var date_end = $('#pembebasan-end').val();
    var upt = $('#pembebasan-batas-waktu-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartPembebasan'
    }, function (res) {
        console.log(res);
        changeViewPembebasanChart(res);
    })
}

var PembebasanChart;
function changeViewPembebasanChart(data) {
    if (PembebasanChart) {
        console.log("kategori destroy");
        PembebasanChart.destroy();
    }

    console.log(data.data.selesai);
    data_selesai = [];
    $.each(data.data.selesai, function (i, v) {
        console.log(v);
        data_selesai.push(v);
    })
    data_proses = [];
    $.each(data.data.proses, function (i, v) {
        data_proses.push(v);
    })
    data_btl = [];
    $.each(data.data.btl, function (i, v) {
        data_btl.push(v);
    })
    data_labels = [];
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
    })

    const pembebasanChartCtx = document.getElementById('pembebasan-chart');
    PembebasanChart = new Chart(pembebasanChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data_labels,
            axis: 'y',
            datasets: [
                {

                    label: 'Selesai',
                    data: data_selesai,
                    backgroundColor: colours[4],
                    borderWidth: 1
                },
                {

                    label: 'Proses',
                    data: data_proses,
                    backgroundColor: colours[3],
                    borderWidth: 1
                },
                {

                    label: 'BTL',
                    data: data_btl,
                    backgroundColor: colours[5],
                    borderWidth: 1
                },
            ]
        },
        options: {
            indexAxis: 'y',
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    stacked: true,
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// Tender
function setTenderChart() {
    var date_start = $('#tender-start').val();
    var date_end = $('#tender-end').val();
    var upt = $('#tender-batas-waktu-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartTender'
    }, function (res) {
        console.log(res);
        changeViewTenderChart(res);
    })
}

var TenderChart;
function changeViewTenderChart(data) {
    if (TenderChart) {
        console.log("kategori destroy");
        TenderChart.destroy();
    }

    console.log(data.data.selesai);
    data_selesai = [];
    $.each(data.data.selesai, function (i, v) {
        console.log(v);
        data_selesai.push(v);
    })
    data_proses = [];
    $.each(data.data.proses, function (i, v) {
        data_proses.push(v);
    })
    data_btl = [];
    $.each(data.data.btl, function (i, v) {
        data_btl.push(v);
    })
    data_labels = [];
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
    })

    const tenderChartCtx = document.getElementById('tender-chart');
    TenderChart = new Chart(tenderChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data_labels,
            axis: 'y',
            datasets: [
                {

                    label: 'Selesai',
                    data: data_selesai,
                    backgroundColor: colours[4],
                    borderWidth: 1
                },
                {

                    label: 'Proses',
                    data: data_proses,
                    backgroundColor: colours[3],
                    borderWidth: 1
                },
                {

                    label: 'BTL',
                    data: data_btl,
                    backgroundColor: colours[5],
                    borderWidth: 1
                },
            ]
        },
        options: {
            indexAxis: 'y',
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    stacked: true,
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// Pelaksanaan
function setPelaksanaanChart() {
    var date_start = $('#pelaksanaan-start').val();
    var date_end = $('#pelaksanaan-end').val();
    var upt = $('#pelaksanaan-batas-waktu-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartPelaksanaan'
    }, function (res) {
        console.log(res);
        changeViewPelaksanaanChart(res);
    })
}

var PelaksanaanChart;
function changeViewPelaksanaanChart(data) {
    if (PelaksanaanChart) {
        console.log("kategori destroy");
        PelaksanaanChart.destroy();
    }

    console.log(data.data.selesai);
    data_selesai = [];
    $.each(data.data.selesai, function (i, v) {
        console.log(v);
        data_selesai.push(v);
    })
    data_proses = [];
    $.each(data.data.proses, function (i, v) {
        data_proses.push(v);
    })
    data_btl = [];
    $.each(data.data.btl, function (i, v) {
        data_btl.push(v);
    })
    data_labels = [];
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
    })

    const pelaksanaanChartCtx = document.getElementById('pelaksanaan-chart');
    PelaksanaanChart = new Chart(pelaksanaanChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data_labels,
            axis: 'y',
            datasets: [
                {

                    label: 'Selesai',
                    data: data_selesai,
                    backgroundColor: colours[4],
                    borderWidth: 1
                },
                {

                    label: 'Proses',
                    data: data_proses,
                    backgroundColor: colours[3],
                    borderWidth: 1
                },
                {

                    label: 'BTL',
                    data: data_btl,
                    backgroundColor: colours[5],
                    borderWidth: 1
                },
            ]
        },
        options: {
            indexAxis: 'y',
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    stacked: true,
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}


// Pemanfaatan
function setPemanfaatanChart() {
    var date_start = $('#pemanfaatan-start').val();
    var date_end = $('#pemanfaatan-end').val();
    var upt = $('#pemanfaatan-batas-waktu-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartPemanfaatan'
    }, function (res) {
        console.log(res);
        changeViewPemanfaatanChart(res);
    })
}

var pemanfaatanChart;
function changeViewPemanfaatanChart(data) {
    if (pemanfaatanChart) {
        console.log("kategori destroy");
        pemanfaatanChart.destroy();
    }

    console.log(data.data.selesai);
    data_selesai = [];
    $.each(data.data.selesai, function (i, v) {
        console.log(v);
        data_selesai.push(v);
    })
    data_proses = [];
    $.each(data.data.proses, function (i, v) {
        data_proses.push(v);
    })
    data_btl = [];
    $.each(data.data.btl, function (i, v) {
        data_btl.push(v);
    })
    data_labels = [];
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
    })

    const pemanfaatanChartCtx = document.getElementById('pemanfaatan-chart');
    pemanfaatanChart = new Chart(pemanfaatanChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data_labels,
            axis: 'y',
            datasets: [
                {

                    label: 'Selesai',
                    data: data_selesai,
                    backgroundColor: colours[4],
                    borderWidth: 1
                },
                {

                    label: 'Proses',
                    data: data_proses,
                    backgroundColor: colours[3],
                    borderWidth: 1
                },
                {

                    label: 'BTL',
                    data: data_btl,
                    backgroundColor: colours[5],
                    borderWidth: 1
                },
            ]
        },
        options: {
            indexAxis: 'y',
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    stacked: true,
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}


// Pengaduan UPT
function setPengaduanUPTChart() {
    var date_start = $('#pengaduan-upt-start').val();
    var date_end = $('#pengaduan-upt-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartPengaduanUPT'
    }, function (res) {
        console.log(res);
        changeViewPengaduanUPTChart(res);
    })
}

var pengaduanUPTChart;
function changeViewPengaduanUPTChart(data) {
    if (pengaduanUPTChart) {
        pengaduanUPTChart.destroy();
    }

    const pengaduanUPTChartCtx = document.getElementById('pengaduan-upt-chart');
    pengaduanUPTChart = new Chart(pengaduanUPTChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: [
                {
                    label: 'Perizinan',
                    data: data.data,
                    backgroundColor: colours[1],
                    borderWidth: 1
                },
            ]
        },
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// Seccond Pengaduan UPT
// Pengaduan UPT
function setBalaiPengaduanTerbanyakChart() {
    var date_start = $('#balai-pengaduan-terbanyak-start').val();
    var date_end = $('#balai-pengaduan-terbanyak-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartBalaiPengaduanTerbanyak'
    }, function (res) {
        console.log(res);
        changeViewBalaiPengaduanTerbanyakChart(res);
    })
}

var balaiPengaduanTerbanyakChart;
function changeViewBalaiPengaduanTerbanyakChart(data) {
    if (balaiPengaduanTerbanyakChart) {
        balaiPengaduanTerbanyakChart.destroy();
    }
    arrayLabel = data.labels
    arrayOfObj = arrayLabel.map(function (d, i) {
        return {
            label: d,
            data: data.data[i] || 0
        };
    });

    sortedArrayOfObj = arrayOfObj.sort(function (a, b) {
        return b.data - a.data;
    });

    newArrayLabel = [];
    newArrayData = [];
    sortedArrayOfObj.forEach(function (d) {
        newArrayLabel.push(d.label);
        newArrayData.push(d.data);
    });

    console.log(newArrayLabel);
    console.log(newArrayData);

    const balaiPengaduanTerbanyakChartCtx = document.getElementById('balai-pengaduan-terbanyak-chart');
    balaiPengaduanTerbanyakChart = new Chart(balaiPengaduanTerbanyakChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: newArrayLabel,
            axis: 'y',
            datasets: [
                {
                    label: 'Terlapor',
                    data: newArrayData,
                    backgroundColor: colours[2],
                    borderWidth: 1
                },
            ]
        },
        options: {
            indexAxis: 'y',
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: false,
                        text: ''
                    }
                },
                x: {
                    title: {
                        display: false,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// Status SIPTL
function setStatusSiptlChart() {
    var date_start = $('#status-siptl-start').val();
    var date_end = $('#status-siptl-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartStatusSiptl'
    }, function (res) {
        console.log(res);
        changeViewStatusSiptlChart(res);
    })
}

var statusSiptlChart;
function changeViewStatusSiptlChart(data) {
    if (statusSiptlChart) {
        console.log("kategori destroy");
        statusSiptlChart.destroy();
    }

    datasets = [];
    data_labels = [];
    backgroundColor = []
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
        datasets.push(data.data[i]);
        backgroundColor.push(colours[i]);
    })

    const statusSiptlChartCtx = document.getElementById('status-siptl-chart');
    statusSiptlChart = new Chart(statusSiptlChartCtx, {
        plugins: [ChartDataLabels],
        type: 'doughnut',
        data: {
            labels: data_labels,
            datasets: [
                {
                    label: 'Data',
                    data: datasets,
                    backgroundColor: backgroundColor,
                    borderWidth: 1
                }
            ]
        },
        options: {
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// Pengaduan Status Verifikasi
function setStatusVerifikasiChart() {
    var date_start = $('#status-verifikasi-start').val();
    var date_end = $('#status-verifikasi-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartStatusVerifikasi'
    }, function (res) {
        console.log(res);
        changeViewStatusVerifikasiChart(res);
    })
}

var statusVerifikasiChart;
function changeViewStatusVerifikasiChart(data) {
    if (statusVerifikasiChart) {
        console.log("kategori destroy");
        statusVerifikasiChart.destroy();
    }

    datasets = [];
    data_labels = [];
    backgroundColor = []
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
        datasets.push(data.data[i]);
        backgroundColor.push(colours[i]);
    })
    const statusVerifikasiChartCtx = document.getElementById('status-verifikasi-chart');
    statusVerifikasiChart = new Chart(statusVerifikasiChartCtx, {
        plugins: [ChartDataLabels],
        type: 'doughnut',
        data: {
            labels: data_labels,
            datasets: [
                {
                    label: 'Data',
                    data: datasets,
                    backgroundColor: backgroundColor,
                    borderWidth: 1
                }
            ]
        },
        options: {
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// Persentase ITJEN
function setPersentaseItjenChart() {
    var date_start = $('#persentase-itjen-start').val();
    var date_end = $('#persentase-itjen-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartPersentaseItjen'
    }, function (res) {
        console.log(res);
        changeViewPersentaseItjenChart(res);
    })
}

var persentaseItjenChart;
function changeViewPersentaseItjenChart(data) {
    if (persentaseItjenChart) {
        persentaseItjenChart.destroy();
    }

    datasets = [];
    data_labels = [];
    backgroundColor = []
    $.each(data.labels, function (i, v) {
        data_labels.push(v);
        datasets.push(data.data[i]);
        backgroundColor.push(colours[i]);
    })

    const persentaseItjenChartCtx = document.getElementById('persentase-itjen-chart');
    persentaseItjenChart = new Chart(persentaseItjenChartCtx, {
        plugins: [ChartDataLabels],
        type: 'doughnut',
        data: {
            labels: data_labels,
            datasets: [
                {
                    label: 'Data',
                    data: datasets,
                    backgroundColor: backgroundColor,
                    borderWidth: 1
                }
            ]
        },
        options: {
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}%`),
                }
            },
        }
    });
}

// Perijinan Batas Waktu
function setPerijinanBatasWaktuChart() {
    var date_start = $('#perijinan-batas-waktu-start').val();
    var date_end = $('#perijinan-batas-waktu-end').val();
    var upt = $('#perijinan-batas-waktu-upt').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        upt,
        'function': 'chartPerijinanBatasWaktu'
    }, function (res) {
        console.log(res);
        changeViewPerijinanBatasWaktuChart(res);
    })
}

var perijinanBatasWaktuChart;
function changeViewPerijinanBatasWaktuChart(data) {
    if (perijinanBatasWaktuChart) {
        perijinanBatasWaktuChart.destroy();
    }
    perijinanBatasWaktuChartColour = [];
    $.each(data.labels, function (i, v) {
        perijinanBatasWaktuChartColour.push(colours[i]);
    })

    const perijinanBatasWaktuChartCtx = document.getElementById('perijinan-batas-waktu-chart');
    perijinanBatasWaktuChart = new Chart(perijinanBatasWaktuChartCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: ["Perizinan"],
            datasets: [
                {
                    label: 'Batas Waktu Terakhir',
                    data: [data.data.sk[0]],
                    backgroundColor: colours[2],
                    borderWidth: 1
                },
                {
                    label: 'Terlambat',
                    data: [data.data.sk[1]],
                    backgroundColor: colours[1],
                    borderWidth: 1
                },
            ]
        },
        options: {
            scales: {
                y: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: true,
                        text: 'Jumlah Perizinan'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// TOP 10 Perizinan Terlambat Chart
function setPerizinanTerlambatChart() {
    var date_start = $('#perizinan-terlambat-start').val();
    var date_end = $('#perizinan-terlambat-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartPerizinanTerlambat'
    }, function (res) {
        console.log(res);
        changeViewPerizinanTerlambatChart(res);
    })
}

var perizinanTerlambat;
function changeViewPerizinanTerlambatChart(data) {
    if (perizinanTerlambat) {
        perizinanTerlambat.destroy();
    }
    perizinanTerlambatColour = [];
    $.each(data.labels, function (i, v) {
        perizinanTerlambatColour.push(colours[i]);
    })

    const perizinanTerlambatCtx = document.getElementById('perizinan-terlambat-chart');
    perizinanTerlambat = new Chart(perizinanTerlambatCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: [
                {
                    label: 'Jumlah Izin yang Terlambat',
                    data: data.data.values,
                    backgroundColor: colours[1],
                    borderWidth: 1
                },
            ]
        },
        options: {
            maintainAspectRatio: false,
            indexAxis: 'y',
            scales: {
                x: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: true,
                        text: 'Jumlah Izin yang Terlambat'
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}

// FULL Perizinan Terlambat Chart
function setPerizinanTerlambatFullChart() {
    var date_start = $('#perizinan-terlambat-full-start').val();
    var date_end = $('#perizinan-terlambat-full-end').val();

    $.get(CURRENT_URL, {
        date_start,
        date_end,
        'function': 'chartPerizinanTerlambatFull'
    }, function (res) {
        console.log(res);
        changeViewPerizinanTerlambatFullChart(res);
    })
}

var perizinanTerlambatFull;
function changeViewPerizinanTerlambatFullChart(data) {
    if (perizinanTerlambatFull) {
        perizinanTerlambatFull.destroy();
    }
    perizinanTerlambatFullColour = [];
    $.each(data.labels, function (i, v) {
        perizinanTerlambatFullColour.push(colours[i]);
    })

    const perizinanTerlambatFullCtx = document.getElementById('perizinan-terlambat-full-chart');
    perizinanTerlambatFull = new Chart(perizinanTerlambatFullCtx, {
        plugins: [ChartDataLabels],
        type: 'bar',
        data: {
            labels: data.labels,
            datasets: [
                {
                    label: 'Jumlah Izin yang Terlambat',
                    data: data.data.values,
                    backgroundColor: colours[1],
                    borderWidth: 1
                },
            ]
        },
        options: {
            maintainAspectRatio: false,
            indexAxis: 'y',
            scales: {
                x: {
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                    title: {
                        display: true,
                        text: 'Jumlah Izin yang terlambat'
                    }
                },
                y: {
                    title: {
                        display: true,
                        text: ''
                    }
                },
            },
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
        }
    });
}


function setTablePerijinan() {
    var colDef = [
        { data: 'nomor_registrasi', render: renderNumRow },
        { data: 'nomor_registrasi' },
        { data: 'tanggal_surat_edit' },
        { data: 'nama_perusahaan' },
        { data: 'nama_balai' },
        { data: 'sumber_air' },
        // { data: 'jenis_permohonan' },
        // { data: 'tujuan_penggunaan_airdayaair' },
        // { data: 'tujuan_penggunaan_sumberair' },
        // { data: 'VERIFIKASI' },
        { data: 'SK_MENTERI' },
    ];
    var reqData = {
        date_start: $('#perijinan-table-start').val(),
        date_end: $('#perijinan-table-end').val(),
        upt: $('#perijinan-table-upt').val(),
    };

    var reqOrder = null;

    tableData = setDataTable('#table-perijinan', urlData, colDef, reqData, reqOrder, null, null, false);
}

function setTableRekapPengaduan() {
    var colDef = [
        { data: 'id', render: renderNumRow },
        { data: 'identitas_pelapor' },
        { data: 'perihal' },
        { data: 'integritas' },
        { data: 'poin_pengaduan' },
    ];
    var reqData = {
        date_start: $('#rekap-table-start').val(),
        date_end: $('#rekap-table-end').val(),
        upt: $('#rekap-table-upt').val(),
    };

    var reqOrder = null;

    tabelRekap = setDataTable('#table-rekap', urlDataB, colDef, reqData, reqOrder, null, null, false);
}


function setChartBPL() {
    am4core.ready(function () {

        // Themes begin
        am4core.useTheme(am4themes_material);
        am4core.useTheme(am4themes_animated);
        // Themes end

        // Create chart instance
        var chart = am4core.create("bpl", am4charts.PieChart);
        chart.startAngle = 160;
        chart.endAngle = 380;

        // Let's cut a hole in our Pie chart the size of 40% the radius
        chart.innerRadius = am4core.percent(40);

        // Add data
        chart.data = [{
            "label": "Belum Tidak Lanjut",
            "litres": 501.9,
            "bottles": 1500
        }, {
            "label": "Proses",
            "litres": 30.9,
            "bottles": 990
        }, {
            "label": "Selesai",
            "litres": 39,
            "bottles": 990
        }];

        // Add and configure Series
        var pieSeries = chart.series.push(new am4charts.PieSeries());
        pieSeries.dataFields.value = "litres";
        pieSeries.dataFields.category = "label";
        pieSeries.slices.template.stroke = new am4core.InterfaceColorSet().getFor("background");
        pieSeries.slices.template.strokeWidth = 1;
        pieSeries.slices.template.strokeOpacity = 1;

        // Disabling labels and ticks on inner circle
        pieSeries.labels.template.disabled = true;
        pieSeries.ticks.template.disabled = true;

        // Disable sliding out of slices
        pieSeries.slices.template.states.getKey("hover").properties.shiftRadius = 0;
        pieSeries.slices.template.states.getKey("hover").properties.scale = 1;
        pieSeries.radius = am4core.percent(40);
        pieSeries.innerRadius = am4core.percent(30);

        var cs = pieSeries.colors;
        cs.list = [am4core.color(new am4core.ColorSet().getIndex(0))];

        cs.stepOptions = {
            lightness: -0.05,
            hue: 0
        };
        cs.wrap = false;


        // Add second series
        var pieSeries2 = chart.series.push(new am4charts.PieSeries());
        pieSeries2.dataFields.value = "bottles";
        pieSeries2.dataFields.category = "label";
        pieSeries2.slices.template.stroke = new am4core.InterfaceColorSet().getFor("background");
        pieSeries2.slices.template.strokeWidth = 1;
        pieSeries2.slices.template.strokeOpacity = 1;
        pieSeries2.slices.template.states.getKey("hover").properties.shiftRadius = 0.05;
        pieSeries2.slices.template.states.getKey("hover").properties.scale = 1;

        pieSeries2.labels.template.disabled = true;
        pieSeries2.ticks.template.disabled = true;


        var label = chart.seriesContainer.createChild(am4core.Label);
        label.textAlign = "middle";
        label.horizontalCenter = "middle";
        label.verticalCenter = "middle";
        label.adapter.add("text", function (text, target) {
            return "[font-size:18px]JUMLAH[/]\n[bold font-size:30px]" + pieSeries.dataItem.values.value.sum + "[/]";
        })

    }); // end am4core.ready()
}

function setChartKKN() {
    am4core.ready(function () {

        // Themes begin
        am4core.useTheme(am4themes_material);
        am4core.useTheme(am4themes_animated);
        // Themes end

        // Create chart instance
        var chart = am4core.create("kkn", am4charts.PieChart);

        // Add and configure Series
        var pieSeries = chart.series.push(new am4charts.PieSeries());
        pieSeries.dataFields.value = "litres";
        pieSeries.dataFields.category = "label";

        // Let's cut a hole in our Pie chart the size of 30% the radius
        chart.innerRadius = am4core.percent(30);

        // Put a thick white border around each Slice
        pieSeries.slices.template.stroke = am4core.color("#fff");
        pieSeries.slices.template.strokeWidth = 2;
        pieSeries.slices.template.strokeOpacity = 1;
        pieSeries.slices.template
            // change the cursor on hover to make it apparent the object can be interacted with
            .cursorOverStyle = [
                {
                    "property": "cursor",
                    "value": "pointer"
                }
            ];

        pieSeries.alignLabels = false;
        pieSeries.labels.template.bent = false;
        pieSeries.labels.template.radius = 3;
        pieSeries.labels.template.padding(0, 0, 0, 0);

        pieSeries.ticks.template.disabled = true;

        // Create a base filter effect (as if it's not there) for the hover to return to
        var shadow = pieSeries.slices.template.filters.push(new am4core.DropShadowFilter);
        shadow.opacity = 0;

        // Create hover state
        var hoverState = pieSeries.slices.template.states.getKey("hover"); // normally we have to create the hover state, in this case it already exists

        // Slightly shift the shadow and make it more prominent on hover
        var hoverShadow = hoverState.filters.push(new am4core.DropShadowFilter);
        hoverShadow.opacity = 0.7;
        hoverShadow.blur = 5;

        // Add a legend
        chart.legend = new am4charts.Legend();

        chart.data = [{
            "label": "Korupsi",
            "litres": 501.9
        }, {
            "label": "Kolusi",
            "litres": 165.8
        }, {
            "label": "Persekongkolan",
            "litres": 165.8
        }, {
            "label": "Penyalahgunaan Wewenang",
            "litres": 165.8
        }, {
            "label": "Ketidaktaatan Pekerjaan",
            "litres": 165.8
        }, {
            "label": "Penipuan Kontrak",
            "litres": 165.8
        }, {
            "label": "Nepotisme",
            "litres": 139.9
        }];

    }); // end am4core.ready()
}

function setChartPengadaan() {
    var date = $('#pengadaan').val();
    $.get(CURRENT_URL, {
        date,
        'function': 'chartPengadaan'
    }, function (res) {
        console.log(res);
        changeViewPengadaan(res);
    })
}

var historyChart;
function changeViewPengadaan(data) {
    if (historyChart) {
        historyChart.destroy();
    }

    var table = "";
    table += "<tr>";
    table += "<th>Paket/Bulan</th>";
    $.each(data.categories, function (i, v) {
        table += "<th class='text-center'>" + v + "</th>"
    })
    table += "</tr>";
    console.log(data.series);
    $.each(data.series, function (i, v) {
        var text_white = "";
        if (i != 2) {
            text_white = "text-white"
        }
        table += "<tr style='background-color: " + colours[i] + "' class='text-center'>";
        table += "<td class='text-center'>" + v.name + "</td>"
        $.each(v.data, function (x, y) {
            table += "<td class='text-bold " + text_white + "'>" + y + "</td>"
        })
        table += "</tr>";
    })
    $('#table-pengadaan').html(table);

    const historyChartCtx = document.getElementById('history-chart');
    datasets = [];
    $.each(data.series, function (i, v) {
        datasets[i] = {
            label: v.name,
            data: v.data,
            backgroundColor: colours[i]
        }
    });

    historyChart = new Chart(historyChartCtx, {
        type: 'bar',
        data: {
            labels: data.categories,
            datasets: datasets
        },
        plugins: [ChartDataLabels],
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    anchor: 'end', // remove this line to get label in middle of the bar
                    align: 'end',
                    formatter: (val) => (`${val}`),
                }
            },
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        stepSize: 1,
                        beginAtZero: true,
                    },
                },
                x: {
                    stacked: true
                },
            },
        },
    });
}

function setChartKemajuan() {
    var date = $('#kemajuan').val();
    $.get(CURRENT_URL, {
        date,
        'function': 'chartKemajuan'
    }, function (res) {
        console.log(res);
        changeViewKemajuan(res);
    })
}

var kemajuanChart;
function changeViewKemajuan(data) {
    if (kemajuanChart) {
        kemajuanChart.destroy();
    }

    var table = "";
    table += "<tr>";
    table += "<th>Paket/Bulan</th>";
    $.each(data.categories, function (i, v) {
        table += "<th class='text-center'>" + v + "</th>"
    })
    table += "</tr>";
    console.log(data.series);
    $.each(data.series, function (i, v) {
        var text_white = "";
        if (i != 2) {
            text_white = "text-white"
        }
        table += "<tr style='background-color: " + colours[i] + "' class='text-center'>";
        table += "<td class='text-center'>" + v.name + "</td>"
        $.each(v.data, function (x, y) {
            table += "<td class='text-bold " + text_white + "'>" + y + "%</td>"
        })
        table += "</tr>";
    })
    $('#table-kemajuan').html(table);

    const kemajuanChartCtx = document.getElementById('kemajuan-chart');
    datasets = [];
    $.each(data.series, function (i, v) {
        datasets[i] = {
            label: v.name,
            data: v.data,
            borderColor: colours[i]
        }
    });

    kemajuanChart = new Chart(kemajuanChartCtx, {
        type: 'line',
        data: {
            labels: data.categories,
            datasets: datasets
        },
        plugins: [ChartDataLabels],
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}

function setTablePengadaanBanding() {
    var date1 = $('#tgl-pengadaan-banding1').val();
    var date2 = $('#tgl-pengadaan-banding2').val();
    var year = $("#tahun-pengadaan-banding").val()
    $.get(CURRENT_URL, {
        date1,
        date2,
        year,
        'function': 'tablePengadaanBanding'
    }, function (res) {
        console.log(res);
        changeViewPengadaanBanding(res);
    })
}

function changeViewPengadaanBanding(data) {
    var table = "";
    var kontraktual_status = 0;
    var terkontrak_status = 0;
    var persiapan_status = 0;
    var proses_status = 0;
    var belum_status = 0;
    var gagal_status = 0;
    $.each(data, function (i, v) {
        table += "<tr class='text-right text-bold'>";
        table += "<td class='text-left'>" + v.tanggal + "</td>";
        table += "<td>" + formatCurrency(v.kontraktual.pkt) + "</td>";
        table += "<td>" + formatCurrency(v.kontraktual.pagu_dipa) + "</td>";
        table += "<td>" + formatCurrency(v.terkontrak.pkt) + "</td>";
        table += "<td>" + formatCurrency(v.terkontrak.pagu_dipa) + "</td>";
        table += "<td>" + formatCurrency(v.persiapan_terkontrak.pkt) + "</td>";
        table += "<td>" + formatCurrency(v.persiapan_terkontrak.pagu_dipa) + "</td>";
        table += "<td>" + formatCurrency(v.proses_lelang.pkt) + "</td>";
        table += "<td>" + formatCurrency(v.proses_lelang.pagu_dipa) + "</td>";
        table += "<td>" + formatCurrency(v.belum_lelang.pkt) + "</td>";
        table += "<td>" + formatCurrency(v.belum_lelang.pagu_dipa) + "</td>";
        table += "<td>" + formatCurrency(v.gagal_lelang.pkt) + "</td>";
        table += "<td>" + formatCurrency(v.gagal_lelang.pagu_dipa) + "</td>";
        table += "</tr>";
    });

    var status_kontraktual = data[1].kontraktual.pkt - data[0].kontraktual.pkt;
    var status_terkontrak = data[1].terkontrak.pkt - data[0].terkontrak.pkt;
    var status_persiapan_terkontrak = data[1].persiapan_terkontrak.pkt - data[0].persiapan_terkontrak.pkt;
    var status_proses_lelang = data[1].proses_lelang.pkt - data[0].proses_lelang.pkt;
    var status_belum_lelang = data[1].belum_lelang.pkt - data[0].belum_lelang.pkt;
    var status_gagal_lelang = data[1].gagal_lelang.pkt - data[0].gagal_lelang.pkt;
    table += "<tr class='text-right text-bold'>";
    table += "<td></td>";
    table += "<td>" + (status_kontraktual > 0 ? "+" : "") + formatCurrency(status_kontraktual) + "</td>"
    table += "<td class='text-center'>" + (status_kontraktual > 0 ? "Naik" : (status_kontraktual < 0 ? "Turun" : "Tetap")) + "</td>";
    table += "<td>" + (status_terkontrak > 0 ? "+" : "") + formatCurrency(status_terkontrak) + "</td>"
    table += "<td class='text-center'>" + (status_terkontrak > 0 ? "Naik" : (status_terkontrak < 0 ? "Turun" : "Tetap")) + "</td>";
    table += "<td>" + (status_persiapan_terkontrak > 0 ? "+" : "") + formatCurrency(status_persiapan_terkontrak) + "</td>"
    table += "<td class='text-center'>" + (status_persiapan_terkontrak > 0 ? "Naik" : (status_persiapan_terkontrak < 0 ? "Turun" : "Tetap")) + "</td>";
    table += "<td>" + (status_proses_lelang > 0 ? "+" : "") + formatCurrency(status_proses_lelang) + "</td>"
    table += "<td class='text-center'>" + (status_proses_lelang > 0 ? "Naik" : (status_proses_lelang < 0 ? "Turun" : "Tetap")) + "</td>";
    table += "<td>" + (status_belum_lelang > 0 ? "+" : "") + formatCurrency(status_belum_lelang) + "</td>"
    table += "<td class='text-center'>" + (status_belum_lelang > 0 ? "Naik" : (status_belum_lelang < 0 ? "Turun" : "Tetap")) + "</td>";
    table += "<td>" + (status_gagal_lelang > 0 ? "+" : "") + formatCurrency(status_gagal_lelang) + "</td>"
    table += "<td class='text-center'>" + (status_gagal_lelang > 0 ? "Naik" : (status_gagal_lelang < 0 ? "Turun" : "Tetap")) + "</td>";
    table += "</tr>";

    $('#table-pengadaan-banding>tbody').html(table);
}

function setChartProsesLelang() {
    var date = $('#proses-lelang').val();
    var year = $('#tahun-proses-lelang').val();

    $.get(CURRENT_URL, {
        date,
        year,
        'function': 'chartProsesLelang'
    }, function (res) {
        console.log(res);
        changeViewProsesLelang(res);
    })
}

var prosesLelangChart;
function changeViewProsesLelang(data) {
    if (prosesLelangChart) {
        prosesLelangChart.destroy();
    }

    $('#proses-lelang-persen02').text((data.proses_lelang02.persen ?? 0).toString().replace('.', ',') + "%")
    $('#proses-lelang-jumlah02').text((data.proses_lelang02.jumlah ?? 0))
    $('#proses-lelang-persen23').text((data.proses_lelang23.persen ?? 0).toString().replace('.', ',') + "%")
    $('#proses-lelang-jumlah23').text((data.proses_lelang23.jumlah ?? 0))
    $('#proses-lelang-persen34').text((data.proses_lelang34.persen ?? 0).toString().replace('.', ',') + "%")
    $('#proses-lelang-jumlah34').text((data.proses_lelang34.jumlah ?? 0))
    $('#proses-lelang-persen4').text((data.proses_lelang4.persen ?? 0).toString().replace('.', ',') + "%")
    $('#proses-lelang-jumlah4').text((data.proses_lelang4.jumlah ?? 0))

    $('#proses-lelang-total-paket-lelang').text(data.total)
    $('#proses-lelang-persen-paket-persentase').text((data.persentase ?? 0).toString().replace('.', ',') + "%")

    const prosesLelangChartCtx = document.getElementById('proses-lelang-chart');
    prosesLelangChart = new Chart(prosesLelangChartCtx, {
        type: 'pie',
        data: {
            labels: ["0-60 Hari", '61-90 Hari', '91-120 Hari', '>120 Hari'],
            datasets: [{
                label: "Proses Lelang",
                data: [data.proses_lelang02.persen, data.proses_lelang23.persen, data.proses_lelang34.persen, data.proses_lelang4.persen],
                backgroundColor: [
                    'rgba(224, 224, 224)',
                    'rgba(255, 255, 0)',
                    'rgba(255, 153, 51)',
                    'rgba(255, 51, 51)',
                ]
            }]
        },
        plugins: [ChartDataLabels],
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}

function setChartTerkontrak() {
    var date = $('#tgl-terkontrak').val();
    var year = $('#tahun-terkontrak').val();
    $.get(CURRENT_URL, {
        date,
        year,
        'function': 'chartTerkontrak'
    }, function (res) {
        console.log(res);
        changeViewTerkontrak(res);
    })
}

var terkontrakChart;
function changeViewTerkontrak(data) {
    if (terkontrakChart) {
        terkontrakChart.destroy();
    }

    $('#terkontrak-persen02').text((data.terkontrak02.persen ?? 0).toString().replace('.', ',') + "%")
    $('#terkontrak-jumlah02').text((data.terkontrak02.jumlah ?? 0))
    $('#terkontrak-persen23').text((data.terkontrak23.persen ?? 0).toString().replace('.', ',') + "%")
    $('#terkontrak-jumlah23').text((data.terkontrak23.jumlah ?? 0))
    $('#terkontrak-persen34').text((data.terkontrak34.persen ?? 0).toString().replace('.', ',') + "%")
    $('#terkontrak-jumlah34').text((data.terkontrak34.jumlah ?? 0))
    $('#terkontrak-persen4').text((data.terkontrak4.persen ?? 0).toString().replace('.', ',') + "%")
    $('#terkontrak-jumlah4').text((data.terkontrak4.jumlah ?? 0))

    $('#terkontrak-total-paket-lelang').text(data.total)
    $('#terkontrak-persen-paket-persentase').text((data.persentase ?? 0).toString().replace('.', ',') + "%")

    const terkontrakChartCtx = document.getElementById('terkontrak-chart');
    terkontrakChart = new Chart(terkontrakChartCtx, {
        type: 'pie',
        data: {
            labels: ["0-60 Hari", '61-90 Hari', '91-120 Hari', '>120 Hari'],
            datasets: [{
                label: "Proses Lelang",
                data: [data.terkontrak02.persen, data.terkontrak23.persen, data.terkontrak34.persen, data.terkontrak4.persen],
                backgroundColor: [
                    'rgba(224, 224, 224)',
                    'rgba(255, 255, 0)',
                    'rgba(255, 153, 51)',
                    'rgba(255, 51, 51)',
                ]
            }]
        },
        plugins: [ChartDataLabels],
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}

function setChartKontrakHPS() {
    var date = $('#tgl-kontrak-hps').val();
    $.get(CURRENT_URL, {
        date,
        'function': 'chartKontrakHPS'
    }, function (res) {
        console.log(res);
        changeViewKontrakHPS(res);
    })
}

var kontrakHPSChart;
function changeViewKontrakHPS(data) {
    if (kontrakHPSChart) {
        kontrakHPSChart.destroy();
    }

    // $('#kontrak-hps-au60').text((data.kontrak_hps60.pengadaan ?? 0));
    // $('#kontrak-hps-au6070').text((data.kontrak_hps6070.pengadaan ?? 0));
    // $('#kontrak-hps-au7080').text((data.kontrak_hps7080.pengadaan ?? 0));
    $('#kontrak-hps-pengadaan60').text((data.kontrak_hps60.pengadaan ?? 0));
    $('#kontrak-hps-pengadaan6070').text((data.kontrak_hps6070.pengadaan ?? 0));
    $('#kontrak-hps-pengadaan7080').text((data.kontrak_hps7080.pengadaan ?? 0));
    $('#kontrak-hps-konstruksi60').text((data.kontrak_hps60.konstruksi ?? 0));
    $('#kontrak-hps-konstruksi6070').text((data.kontrak_hps6070.konstruksi ?? 0));
    $('#kontrak-hps-konstruksi7080').text((data.kontrak_hps7080.konstruksi ?? 0));
    $('#kontrak-hps-konsultansi-bu60').text((data.kontrak_hps60.konsultansi_bu ?? 0));
    $('#kontrak-hps-konsultansi-bu6070').text((data.kontrak_hps6070.konsultansi_bu ?? 0));
    $('#kontrak-hps-konsultansi-bu7080').text((data.kontrak_hps7080.konsultansi_bu ?? 0));
    $('#kontrak-hps-konsultansi-orang60').text((data.kontrak_hps60.konsultansi_orang ?? 0));
    $('#kontrak-hps-konsultansi-orang6070').text((data.kontrak_hps6070.konsultansi_orang ?? 0));
    $('#kontrak-hps-konsultansi-orang7080').text((data.kontrak_hps7080.konsultansi_orang ?? 0));
    $('#kontrak-hps-lainnya60').text((data.kontrak_hps60.lainnya ?? 0));
    $('#kontrak-hps-lainnya6070').text((data.kontrak_hps6070.lainnya ?? 0));
    $('#kontrak-hps-lainnya7080').text((data.kontrak_hps7080.lainnya ?? 0));
    // $('#kontrak-hps-cadangan60').text((data.kontrak_hps60.cadangan ?? 0));
    // $('#kontrak-hps-cadangan6070').text((data.kontrak_hps6070.cadangan ?? 0));
    // $('#kontrak-hps-cadangan7080').text((data.kontrak_hps7080.cadangan ?? 0));
    $('#kontrak-hps-jumlah60').text((data.kontrak_hps60.jumlah ?? 0));
    $('#kontrak-hps-jumlah6070').text((data.kontrak_hps6070.jumlah ?? 0));
    $('#kontrak-hps-jumlah7080').text((data.kontrak_hps7080.jumlah ?? 0));
    $('#kontrak-hps-persentase60').text((data.kontrak_hps60.persentase ?? 0).toString().replace('.', ',') + "%");
    $('#kontrak-hps-persentase6070').text((data.kontrak_hps6070.persentase ?? 0).toString().replace('.', ',') + "%");
    $('#kontrak-hps-persentase7080').text((data.kontrak_hps7080.persentase ?? 0).toString().replace('.', ',') + "%");

    // $('#kontrak-hps-au-total').text(data.total.pengadaan)
    $('#kontrak-hps-pengadaan-total').text(data.total.pengadaan)
    $('#kontrak-hps-konstruksi-total').text(data.total.konstruksi)
    $('#kontrak-hps-konsultansi-bu-total').text(data.total.konsultansi_bu)
    $('#kontrak-hps-konsultansi-orang-total').text(data.total.konsultansi_orang)
    $('#kontrak-hps-lainnya-total').text(data.total.lainnya)
    // $('#kontrak-hps-cadangan-total').text(data.total.cadangan)
    $('#kontrak-hps-jumlah-total').text(data.total.jumlah)
    $('#kontrak-hps-persentase-total').text(data.total.persentase.toString().replace('.', ',') + "%")

    const kontrakHPSChartCtx = document.getElementById('kontrak-hps-chart');
    kontrakHPSChart = new Chart(kontrakHPSChartCtx, {
        type: 'pie',
        data: {
            labels: ["< 60%", '>= 60% dan < 70%', '>= 70% dan < 80%'],
            datasets: [{
                label: "HPS",
                data: [data.kontrak_hps60.jumlah, data.kontrak_hps6070.jumlah, data.kontrak_hps7080.jumlah,],
                backgroundColor: [
                    'rgba(224, 224, 224)',
                    'rgba(255, 255, 0)',
                    'rgba(255, 153, 51)',
                ]
            }]
        },
        plugins: [ChartDataLabels],
        options: {
            responsive: true,
            plugins: {
                datalabels: {
                    formatter: (val) => (`${val}`),
                }
            },
        },
    });
}

function setStatusPaketBelumLelang() {
    var date = $('#status-paket-belum-lelang-tgl').val();
    var year = $('#tahun-status-paket-belum-lelang').val();
    // var date_start = $('#status-paket-belum-lelang-start').val();
    // var date_end = $('#status-paket-belum-lelang-end').val();
    $.get(CURRENT_URL, {
        date,
        year,
        // date_start,
        // date_end,
        'function': 'chartStatusPaketBelumLelang'
    }, function (res) {
        console.log(res);
        changeViewStatusPaketBelumLelang(res);
    })
}

function changeViewStatusPaketBelumLelang(data) {
    $('#spbl-total-paket').text(data.total_paket);
    $('#spbl-total-myc').text(data.total_myc);
    $('#spbl-myc-phln').text(data.total_myc_phln);
    $('#spbl-myc-rmp').text(data.total_myc_rmp);
    $('#spbl-total-syc').text(data.total_syc);
    $('#spbl-syc-phln').text(data.total_syc_phln);
    $('#spbl-syc-rmp').text(data.total_syc_rmp);

    var tbody = "";
    var kategori;
    $.each(data.table, function (i, v) {
        switch (v.kdkategori) {
            case '1':
                kategori = "Barang";
                break;
            case '2':
                kategori = "Pekerjaan Konstruksi";
                break;
            case '3':
                kategori = "jasa konsultansi (badan usaha)";
                break;
            case '4':
                kategori = "Jasa Konsultansi (orang)";
                break;
            case '5':
                kategori = "Jasa Lainnya";
                break;
            case '6':
                kategori = "Cadangan";
                break;

            default:
                kategori = "AU";
                break;
        }
        tbody += `
        <tr>
            <td text-left>${kategori}</td>
            <td>${v.jumlah_paket}</td>
            <td class="text-right">${formatCurrency(v.pg)}</td>
            <td>${v.syc}</td>
            <td>${v.myc}</td>
        </tr>
        `;
    });
    $('.table-spbl tbody').html(tbody);

    $('#table-spbl-total-paket').text(data.total_paket);
    $("#table-spbl-total-pagu").text(formatCurrency(data.total_pagu));
    $("#table-spbl-total-syc").text(data.total_syc);
    $("#table-spbl-total-myc").text(data.total_myc);

    var tbody_pkt = "";
    var kategori;
    var jnskon;
    var sumber_dana;
    $.each(data.paket, function (i, v) {
        switch (v.kdkategori) {
            case '1':
                kategori = "Barang";
                break;
            case '2':
                kategori = "Pekerjaan Konstruksi";
                break;
            case '3':
                kategori = "jasa konsultansi (badan usaha)";
                break;
            case '4':
                kategori = "Jasa Konsultansi (orang)";
                break;
            case '5':
                kategori = "Jasa Lainnya";
                break;
            case '6':
                kategori = "Cadangan";
                break;

            default:
                kategori = "AU";
                break;
        }

        switch (v.kdjnskon) {
            case '1':
                jnskon = "MYC Baru";
                break;
            case '2':
                jnskon = "MYC Lanjutan";
                break;
            case '3':
                jnskon = "MYC Usulan";
                break;
            default:
                jnskon = "SYC";
                break;
        }

        if (v.rmp > 0) {
            sumber_dana = "RMP";
        } else if (v.phln > 0) {
            sumber_dana = "PHLN";
        } else {
            sumber_dana = "SBSN";
        }

        tbody_pkt += `
        <tr>
            <td>${v.nmsatker}</td>
            <td>${v.nmpaket}</td>
            <td>${kategori}</td>
            <td>${jnskon}</td>
            <td>${sumber_dana}</td>
        </tr>
        `;
    });
    $('.table-paket tbody').html(tbody_pkt);
}

function changeViewDate(type, year, selector) {
    $.get(CURRENT_URL + "/change-date", {
        type,
        year
    }, function (res) {
        if (res.status == 1) {
            var option = '';
            $.each(res.data, function (i, v) {
                option += '<option>' + v.tgl_backup + '</option>';
            })
            $(selector).html(option);
            $(selector).select2({ width: "100%" }).change();
        } else {
            swal("Kesalahan", 'Terjadi kesalahan', 'error');
        }
    })
}
